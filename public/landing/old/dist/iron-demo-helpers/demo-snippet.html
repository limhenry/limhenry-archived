<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../iron-icons/iron-icons.html">
<link rel="import" href="../marked-element/marked-element.html">
<link rel="import" href="../paper-icon-button/paper-icon-button.html">
<link rel="import" href="../paper-styles/color.html">
<link rel="import" href="../paper-styles/shadow.html">
<link rel="import" href="../prism-element/prism-highlighter.html">

<!--
`demo-snippet` is a helper element that displays the source of a code snippet and
its rendered demo. It can be used for both native elements and
Polymer elements.

    Example of a native element demo

        <demo-snippet>
          <template>
            <input type="date">
          </template>
        </demo-snippet>

    Example of a Polymer <paper-checkbox> demo

        <demo-snippet>
          <template>
            <paper-checkbox>Checkbox</paper-checkbox>
            <paper-checkbox checked>Checkbox</paper-checkbox>
          </template>
        </demo-snippet>

### Styling

The following custom properties and mixins are available for styling:

Custom property | Description | Default
----------------|-------------|----------
`--demo-snippet` | Mixin applied to the entire element | `{}`
`--demo-snippet-demo` | Mixin applied to just the demo section | `{}`
`--demo-snippet-code` | Mixin applied to just the code section | `{}`

@element demo-snippet
@demo demo/index.html
-->

<dom-module id="demo-snippet">
  <template>
    <style>.code,.demo{padding:20px;margin:0}:host{display:block;@apply(--shadow-elevation-2dp);@apply(--demo-snippet)}.demo{border-bottom:1px solid var(--google-grey-300);background-color:#fff;@apply(--demo-snippet-demo)}.code{background-color:var(--google-grey-100);font-size:13px;overflow:auto;@apply(--demo-snippet-code)}.code>pre{margin:0;padding:0 0 10px}.code-container{position:relative}paper-icon-button{position:absolute;top:0;right:0}</style>

    <prism-highlighter></prism-highlighter>

    <div class="demo">
      <content id="content"></content>
    </div>

    <div class="code-container">
      <marked-element markdown="[[_markdown]]" id="marked">
        <div class="markdown-html code" id="code"></div>
      </marked-element>
      <paper-icon-button id="copyButton" icon="content-copy" title="copy to clipboard" on-tap="_copyToClipboard">
      </paper-icon-button>
    </div>
  </template>

  <script>"use strict";Polymer({is:"demo-snippet",properties:{_markdown:{type:String,value:""}},attached:function(){var e=Polymer.dom(this).queryDistributedElements("template")[0];if(!e)return void(this._markdown="```\n```");var t=this.$.marked.unindent(e.innerHTML);t=t.replace(/=""/g,""),this._markdown="```\n"+t+"\n```",Polymer.dom(this).appendChild(document.importNode(e.content,!0))},_copyToClipboard:function(){var e=document.createRange();e.selectNodeContents(this.$.code);var t=window.getSelection();t.removeAllRanges(),t.addRange(e);var o=!1;try{o=document.execCommand("copy"),this.$.copyButton.icon="done"}catch(n){console.error(n),this.$.copyButton.icon="error"}return setTimeout(this._resetCopyButtonState.bind(this),1e3),t.removeAllRanges(),o},_resetCopyButtonState:function(){this.$.copyButton.icon="content-copy"}});</script>

</dom-module>
